import { expect, test } from "@jest/globals";
import { buildTestData } from "./data";
import { buildSchemaModel } from "./schema";

test("buildTestData", () => {
  const model = `
    type User {
      name: String!
      profile: Profile
      class: Class!
      clubs: [Club!]!
    }
    type Profile {
      age: Int
    }
    type Class {
      name: String!
      users: [User!]!
    }
    type Club {
      name: String!
      users: [User!]!
    }
  `;

  const schema = buildSchemaModel(model);
  const testData = buildTestData(schema);
  const data = testData.map((data) => ({ ...data, values: data.values.map((v) => v.map((v) => v.value)) }));

  expect(data).toMatchInlineSnapshot(`
    Array [
      Object {
        "fieldNames": Array [
          "id",
          "version",
          "createdAt",
          "updatedAt",
          "isDeleted",
          "name",
        ],
        "recordCount": 3,
        "typeIndex": 0,
        "typeName": "Class",
        "values": Array [
          Array [
            "00000000-0000-4000-a000-000000000001",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-1",
          ],
          Array [
            "00000000-0000-4000-a000-000000000002",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-2",
          ],
          Array [
            "00000000-0000-4000-a000-000000000003",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-3",
          ],
        ],
      },
      Object {
        "fieldNames": Array [
          "id",
          "version",
          "createdAt",
          "updatedAt",
          "isDeleted",
          "name",
        ],
        "recordCount": 3,
        "typeIndex": 1,
        "typeName": "Club",
        "values": Array [
          Array [
            "00000000-0000-4000-a000-000100000001",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-1",
          ],
          Array [
            "00000000-0000-4000-a000-000100000002",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-2",
          ],
          Array [
            "00000000-0000-4000-a000-000100000003",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "name-3",
          ],
        ],
      },
      Object {
        "fieldNames": Array [
          "id",
          "version",
          "createdAt",
          "updatedAt",
          "isDeleted",
          "clubId",
          "userId",
        ],
        "recordCount": 27,
        "typeIndex": 2,
        "typeName": "ClubToUser",
        "values": Array [
          Array [
            "00000000-0000-4000-a000-000200000001",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000001",
          ],
          Array [
            "00000000-0000-4000-a000-000200000002",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000002",
          ],
          Array [
            "00000000-0000-4000-a000-000200000003",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000003",
          ],
          Array [
            "00000000-0000-4000-a000-000200000004",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000004",
          ],
          Array [
            "00000000-0000-4000-a000-000200000005",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000005",
          ],
          Array [
            "00000000-0000-4000-a000-000200000006",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000006",
          ],
          Array [
            "00000000-0000-4000-a000-000200000007",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000007",
          ],
          Array [
            "00000000-0000-4000-a000-000200000008",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000008",
          ],
          Array [
            "00000000-0000-4000-a000-000200000009",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000009",
          ],
          Array [
            "00000000-0000-4000-a000-000200000010",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000001",
          ],
          Array [
            "00000000-0000-4000-a000-000200000011",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000002",
          ],
          Array [
            "00000000-0000-4000-a000-000200000012",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000003",
          ],
          Array [
            "00000000-0000-4000-a000-000200000013",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000004",
          ],
          Array [
            "00000000-0000-4000-a000-000200000014",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000005",
          ],
          Array [
            "00000000-0000-4000-a000-000200000015",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000006",
          ],
          Array [
            "00000000-0000-4000-a000-000200000016",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000007",
          ],
          Array [
            "00000000-0000-4000-a000-000200000017",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000008",
          ],
          Array [
            "00000000-0000-4000-a000-000200000018",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000009",
          ],
          Array [
            "00000000-0000-4000-a000-000200000019",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000001",
          ],
          Array [
            "00000000-0000-4000-a000-000200000020",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000002",
          ],
          Array [
            "00000000-0000-4000-a000-000200000021",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000003",
          ],
          Array [
            "00000000-0000-4000-a000-000200000022",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000004",
          ],
          Array [
            "00000000-0000-4000-a000-000200000023",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000005",
          ],
          Array [
            "00000000-0000-4000-a000-000200000024",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000006",
          ],
          Array [
            "00000000-0000-4000-a000-000200000025",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000001",
            "00000000-0000-4000-a000-000400000007",
          ],
          Array [
            "00000000-0000-4000-a000-000200000026",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000002",
            "00000000-0000-4000-a000-000400000008",
          ],
          Array [
            "00000000-0000-4000-a000-000200000027",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000100000003",
            "00000000-0000-4000-a000-000400000009",
          ],
        ],
      },
      Object {
        "fieldNames": Array [
          "id",
          "version",
          "createdAt",
          "updatedAt",
          "isDeleted",
          "age",
          "userId",
        ],
        "recordCount": 9,
        "typeIndex": 3,
        "typeName": "Profile",
        "values": Array [
          Array [
            "00000000-0000-4000-a000-000300000001",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000001",
          ],
          Array [
            "00000000-0000-4000-a000-000300000002",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000002",
          ],
          Array [
            "00000000-0000-4000-a000-000300000003",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000003",
          ],
          Array [
            "00000000-0000-4000-a000-000300000004",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000004",
          ],
          Array [
            "00000000-0000-4000-a000-000300000005",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000005",
          ],
          Array [
            "00000000-0000-4000-a000-000300000006",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000006",
          ],
          Array [
            "00000000-0000-4000-a000-000300000007",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000007",
          ],
          Array [
            "00000000-0000-4000-a000-000300000008",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000008",
          ],
          Array [
            "00000000-0000-4000-a000-000300000009",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            0,
            "00000000-0000-4000-a000-000400000009",
          ],
        ],
      },
      Object {
        "fieldNames": Array [
          "id",
          "version",
          "createdAt",
          "updatedAt",
          "isDeleted",
          "classId",
          "name",
        ],
        "recordCount": 9,
        "typeIndex": 4,
        "typeName": "User",
        "values": Array [
          Array [
            "00000000-0000-4000-a000-000400000001",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000001",
            "name-1",
          ],
          Array [
            "00000000-0000-4000-a000-000400000002",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000002",
            "name-2",
          ],
          Array [
            "00000000-0000-4000-a000-000400000003",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000003",
            "name-3",
          ],
          Array [
            "00000000-0000-4000-a000-000400000004",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000001",
            "name-4",
          ],
          Array [
            "00000000-0000-4000-a000-000400000005",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000002",
            "name-5",
          ],
          Array [
            "00000000-0000-4000-a000-000400000006",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000003",
            "name-6",
          ],
          Array [
            "00000000-0000-4000-a000-000400000007",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000001",
            "name-7",
          ],
          Array [
            "00000000-0000-4000-a000-000400000008",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000002",
            "name-8",
          ],
          Array [
            "00000000-0000-4000-a000-000400000009",
            1,
            1970-01-01T00:00:00.000Z,
            1970-01-01T00:00:00.000Z,
            false,
            "00000000-0000-4000-a000-000000000003",
            "name-9",
          ],
        ],
      },
    ]
  `);
});
